<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I</title>

<meta property="description" itemprop="description" content="Mô hình hỗn hợp (Mixed-effects model) I"/>

<link rel="canonical" href="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<link rel="icon" type="image/vnd.microsoft.icon" href="../../favicon.ico"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2024-07-21"/>
<meta property="article:created" itemprop="dateCreated" content="2024-07-21"/>
<meta name="article:author" content="Bùi Tuấn Anh"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Mô hình hỗn hợp (Mixed-effects model) I"/>
<meta property="og:url" content="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"/>
<meta property="og:image" content="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/2024-07-21-mixed-model-intercept_files/figure-html5/fig1-1.svg"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Bui Tuan Anh"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I"/>
<meta property="twitter:description" content="Mô hình hỗn hợp (Mixed-effects model) I"/>
<meta property="twitter:url" content="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"/>
<meta property="twitter:image" content="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/2024-07-21-mixed-model-intercept_files/figure-html5/fig1-1.svg"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I"/>
<meta name="citation_fulltext_html_url" content="https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2024/07/21"/>
<meta name="citation_publication_date" content="2024/07/21"/>
<meta name="citation_author" content="Bùi Tuấn Anh"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Should i use fixed effects or random effects when i have fewer than five levels of a grouping factor in a mixed-effects model?;citation_publisher=PeerJ Inc.;citation_volume=10;citation_author=Dylan GE Gomes"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","output","bibliography","draft","tags","categories","editor_options","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["Mô hình hỗn hợp (Mixed-effects model) I"]},{"type":"character","attributes":{},"value":["Mô hình hỗn hợp (Mixed-effects model) I"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Bùi Tuấn Anh"]},{"type":"character","attributes":{},"value":["https://bui-tuananh.github.io"]}]}]},{"type":"character","attributes":{},"value":["2024-07-21"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","css","df_print"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["../../styles.css"]},{"type":"character","attributes":{},"value":["kable_df"]}]}]},{"type":"character","attributes":{},"value":["../../bibs/bib.bib"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["tag1","tag2"]},{"type":"character","attributes":{},"value":["cat1","cat2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["markdown"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["wrap"]}},"value":[{"type":"integer","attributes":{},"value":[72]}]}]},{"type":"character","attributes":{},"value":["https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"]},{"type":"character","attributes":{},"value":["https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2024-07-21-mixed-model-intercept_files/anchor-4.2.2/anchor.min.js","2024-07-21-mixed-model-intercept_files/bowser-1.9.3/bowser.min.js","2024-07-21-mixed-model-intercept_files/core-js-2.5.3/LICENSE","2024-07-21-mixed-model-intercept_files/core-js-2.5.3/package.json","2024-07-21-mixed-model-intercept_files/core-js-2.5.3/shim.min.js","2024-07-21-mixed-model-intercept_files/distill-2.2.21/template.v2.js","2024-07-21-mixed-model-intercept_files/figure-html5/fig1-1.svg","2024-07-21-mixed-model-intercept_files/figure-html5/fig2-1.svg","2024-07-21-mixed-model-intercept_files/figure-html5/fig3-1.svg","2024-07-21-mixed-model-intercept_files/header-attrs-2.25/header-attrs.js","2024-07-21-mixed-model-intercept_files/htmlwidgets-1.6.4/htmlwidgets.js","2024-07-21-mixed-model-intercept_files/jquery-3.6.0/jquery-3.6.0.js","2024-07-21-mixed-model-intercept_files/jquery-3.6.0/jquery-3.6.0.min.js","2024-07-21-mixed-model-intercept_files/jquery-3.6.0/jquery-3.6.0.min.map","2024-07-21-mixed-model-intercept_files/kePrint-0.0.1/kePrint.js","2024-07-21-mixed-model-intercept_files/lightable-0.0.1/lightable.css","2024-07-21-mixed-model-intercept_files/popper-2.6.0/popper.min.js","2024-07-21-mixed-model-intercept_files/react-18.2.0/AUTHORS","2024-07-21-mixed-model-intercept_files/react-18.2.0/LICENSE.txt","2024-07-21-mixed-model-intercept_files/react-18.2.0/react-dom.min.js","2024-07-21-mixed-model-intercept_files/react-18.2.0/react.min.js","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.css","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.js","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.js.map","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.server.js","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.server.js.LICENSE.txt","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.server.js.map","2024-07-21-mixed-model-intercept_files/reactable-0.4.4/reactable.yaml","2024-07-21-mixed-model-intercept_files/reactable-binding-0.4.4/reactable.js","2024-07-21-mixed-model-intercept_files/reactwidget-1.0.0/react-tools.js","2024-07-21-mixed-model-intercept_files/reactwidget-1.0.0/react-tools.js.map","2024-07-21-mixed-model-intercept_files/tippy-6.2.7/tippy-bundle.umd.min.js","2024-07-21-mixed-model-intercept_files/tippy-6.2.7/tippy-light-border.css","2024-07-21-mixed-model-intercept_files/tippy-6.2.7/tippy.css","2024-07-21-mixed-model-intercept_files/tippy-6.2.7/tippy.umd.min.js","2024-07-21-mixed-model-intercept_files/webcomponents-2.0.0/webcomponents.js","index.html","index_files/anchor-4.2.2/anchor.min.js","index_files/bowser-1.9.3/bowser.min.js","index_files/core-js-2.5.3/LICENSE","index_files/core-js-2.5.3/package.json","index_files/core-js-2.5.3/shim.min.js","index_files/distill-2.2.21/template.v2.js","index_files/figure-html5/fig1-1.svg","index_files/figure-html5/fig2-1.svg","index_files/figure-html5/fig3-1.svg","index_files/figure-html5/unnamed-chunk-1-1.svg","index_files/figure-html5/unnamed-chunk-10-1.svg","index_files/figure-html5/unnamed-chunk-2-1.svg","index_files/figure-html5/unnamed-chunk-3-1.svg","index_files/figure-html5/unnamed-chunk-3-2.svg","index_files/figure-html5/unnamed-chunk-4-1.svg","index_files/figure-html5/unnamed-chunk-5-1.svg","index_files/figure-html5/unnamed-chunk-6-1.svg","index_files/header-attrs-2.25/header-attrs.js","index_files/htmlwidgets-1.6.4/htmlwidgets.js","index_files/jquery-3.6.0/jquery-3.6.0.js","index_files/jquery-3.6.0/jquery-3.6.0.min.js","index_files/jquery-3.6.0/jquery-3.6.0.min.map","index_files/popper-2.6.0/popper.min.js","index_files/react-18.2.0/AUTHORS","index_files/react-18.2.0/LICENSE.txt","index_files/react-18.2.0/react-dom.min.js","index_files/react-18.2.0/react.min.js","index_files/reactable-0.4.4/reactable.css","index_files/reactable-0.4.4/reactable.js","index_files/reactable-0.4.4/reactable.js.map","index_files/reactable-0.4.4/reactable.server.js","index_files/reactable-0.4.4/reactable.server.js.LICENSE.txt","index_files/reactable-0.4.4/reactable.server.js.map","index_files/reactable-0.4.4/reactable.yaml","index_files/reactable-binding-0.4.4/reactable.js","index_files/reactwidget-1.0.0/react-tools.js","index_files/reactwidget-1.0.0/react-tools.js.map","index_files/tippy-6.2.7/tippy-bundle.umd.min.js","index_files/tippy-6.2.7/tippy-light-border.css","index_files/tippy-6.2.7/tippy.css","index_files/tippy-6.2.7/tippy.umd.min.js","index_files/webcomponents-2.0.0/webcomponents.js","template-blog_files/anchor-4.2.2/anchor.min.js","template-blog_files/bowser-1.9.3/bowser.min.js","template-blog_files/distill-2.2.21/template.v2.js","template-blog_files/header-attrs-2.25/header-attrs.js","template-blog_files/jquery-3.6.0/jquery-3.6.0.js","template-blog_files/jquery-3.6.0/jquery-3.6.0.min.js","template-blog_files/jquery-3.6.0/jquery-3.6.0.min.map","template-blog_files/popper-2.6.0/popper.min.js","template-blog_files/tippy-6.2.7/tippy-bundle.umd.min.js","template-blog_files/tippy-6.2.7/tippy-light-border.css","template-blog_files/tippy-6.2.7/tippy.css","template-blog_files/tippy-6.2.7/tippy.umd.min.js","template-blog_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
  <script src="../../site_libs/react-18.2.0/react.min.js"></script>
  <script src="../../site_libs/react-18.2.0/react-dom.min.js"></script>
  <script src="../../site_libs/reactwidget-1.0.0/react-tools.js"></script>
  <script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <link href="../../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
  <script src="../../site_libs/reactable-binding-0.4.4/reactable.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-79528685-1"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-79528685-1');
</script>
<style type="text/css">
@import url("pygment_highlights.css");
@import url(https://fonts.googleapis.com/css?family=Roboto:400,400italic,500,500italic,700,700italic,900,900italic,300italic,300,100italic,100);
@import url("https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono|Roboto+Condensed|Open+Sans|Open+Sans+Condensed:300|Open+Sans+Condensed:light|Lato|Lora|Fira+Sans|Fira+Mono");
@import url("http://fonts.googleapis.com/css?family=Lato:400,700");

body {
  font-family: 'Computer Modern', Roboto, 'Libre Baskerville', sans-serif; /*, et-book, "Palatino Linotype", "Palatino LT STD", 'Lora', serif*/
  font-size: 15px;
  font-weight: 300;
  color: #404040;        /* #404040*/
  position: relative;
  background: #ffffff;      /* {{ site.page-col }}; */ /*#FFFFF8*/
  text-align: justify;
}

/* distill specific */

d-title h1 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-weight: 600;
  font-size: 50px;
  color: #000001;
  margin-top: 4rem;
  margin-bottom: 1.5rem;
  line-height: 1;
}

.index-title h1 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-weight: 200;
  font-size: 75px;
  font-variant: small-caps;
  text-align: center;
  color: #000001;
  margin-top: 4rem;
  margin-bottom: 1.5rem;
  line-height: 1;
  border-bottom: 0; /*same as default h2*/
  padding-bottom: 1rem; 
}

d-article h1 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-style: normal;
  font-variant: small-caps;
  font-weight: 600;
  font-size: 175%;
  color: #000001;
  margin-top: 2.1rem;
  margin-bottom: 1.2rem;
  line-height: 1;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1); /*same as default h2*/
  padding-bottom: 1rem;
}

d-article h2 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-style: normal;
  font-weight: 600;
  font-size: 150%;
  color: #000001;
  margin-top: 2.1rem;
  margin-bottom: 1.2rem;
  line-height: 1;
  /* to remove will require something to keep the inline from inserting */
  border-bottom: 0px solid rgba(0, 0, 0, 0.1); 
  padding-bottom: 1rem; 
  
}


d-article h3 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-style: normal;
  font-weight: 600;
  font-size: 125%;
  color: #000001;
  opacity: .9;
  margin-top: 2rem;
  margin-bottom: 1.2rem;
  line-height: 1;
}

d-article  h4 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-style: normal;
  text-transform: none;  /*default is uppercase*/
  font-weight: 400;
  font-size: 110%;
  color: #000001;
  opacity: .9;
  margin-top: 1.9rem;
  margin-bottom: 1.2rem;
  line-height: 1;
}

d-article  h5 {
  font-family: 'Open Sans Condensed', Roboto, Helvetica, Arial, sans;
  font-style: normal;
  text-transform: none;  /*default is uppercase*/
  font-weight: 400;
  font-size: 100%;
  color: #000001;
  opacity: .9;
  margin-top: 1.9rem;
  margin-bottom: 1.2rem;
  line-height: 1;
}

dl {
  display: grid;
  grid-template-columns: max-content auto;
}

dt {
  grid-column-start: 1;
}

dd {
  grid-column-start: 2;
}

/* Nav bar */

.distill-site-nav {
  color: #404040;
  background-color: #d9edf7; /*#d9edf7*/
  font-size: 20px;
  font-weight: 300;
}


.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: #0085a1;
}

/* sidebar on front page with category listing */

.posts-with-sidebar .posts-sidebar {
  float: right;
  width: 10%;    /* default 20, made narrow */
  margin-top: 60px;
  padding-top: 24px;
  padding-bottom: 24px;
}

/* attempt to make result not so wide/spacious */ 

.posts-with-sidebar .posts-list {
  width: 66%;
  margin-left: 11%;
}

.posts-sidebar {
  font-size: 75%;
  margin-right: 10%;
}


/* thumbnail images on preview
.thumbnail {
    padding: 0px!important;
    margin: 0px!important;
    max-width: 10%!important;
    height: auto!important;
    vertical-align: text-top!important;
}
 */



/* code */

/* will now work as of latest distill version*/

d-article div.sourceCode code, d-article pre code {
  font-family: 'Roboto Mono', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  color: #404040FF;
  font-size: 90%;
}


d-article pre {
  background-color: #FFFFF8;
}

/* Otherwise will leave a white background visible at bottom of code chunks*/
d-article div.sourceCode {
  background-color: #FFFFF8;
}


/* code results/output */

pre.text-output {
  font-family: 'Roboto Mono', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  color: #000000CC;
}



/* latex */
.math {
  color: #404040;  
  font-weight: normal;
  font-size: 90%;
}


/* link effects; appendix apply to footnote return links */

/*remove old line*/
d-article a:hover {
  text-decoration: none;
  border-bottom: none;
  background-size: 100% 100%;
  cursor: pointer;
}


/* add new effects */
p a, aside a, li a, d-appendix a, a.footnote-backlink {
    color: #15b7d6;
    display: inline-block;
    text-decoration: none;
    transition: background-size .4s ease;
    border-bottom: 0px solid;
}

p a {
  /* text-decoration: underline */
  color: #15b7d6;
}

p a:after, aside a:after, li a:after, d-appendix a:after {
    content: '';
    display: block;
    width: 0;
    height: 1.25px;
    background: #FF4F03;
    transition: width .3s;
}

p a:hover::after, aside a:hover::after, li a:hover::after, d-appendix a:hover::after {
  width: 100%;
  //transition: width .3s;
 }

/* for twitter etc icon links */
.social-icon {
  color: #15b7d6;
  background-image: none;  /* remove hover line*/
  background-size: 0 100%;
  background-repeat: no-repeat;
  text-decoration: none;
  transition: background-size .4s ease;
  border-bottom: 0px solid;
}

d-footnote-list a.footnote-backlink {
    color:  #15b7d6 !important; /* otherwise some inline injection will occur*/
    padding-left: 0.5em;
}

.categories li > a:hover {
  border-bottom: none !important;
}

/* remove underline for TOC */
.d-contents nav a:hover {
    text-decoration: none;
}



/* text highlights */
.emph, em {
  color: #E32D00;  /*#ff5500 #D14300*/
  font-style: normal;
  font-weight: 450;
}

/* don't do color for references */
.references em {
  color: rgba(0,0,0,0.5);
  font-style: normal;
  font-weight: 450;
}

strong {
  color: #404040;  
}

/* pack func and objclass colors initially come from hcl(seq(90,360, length.out=4), c=80, l=80); redone for contrast*/
.pack {
  color: #1f65b7; /* #990071 #AC9CFF #e41a1c*/
  font-weight: 400;
}

.func {
  color: #007020;   /*#007199 #00CBB6; #984ea3; can just use `` instead*/
  font-weight: 400;
}

.objclass {
  color:  #947100;  /*#AAB400 #4daf4a; #FFC5D0*/
  font-weight: 400;
}

/* object/class via inline code */
p code {
  color: #947100;
}


/* figures and tables */

d-article table {
    border-collapse: collapse;
    margin-top: 20px;
    margin-bottom: 20px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

.gt_table {
  background-color: transparent !important; /*ignored*/
}

.gt_col_headings{
  background-color: #ffffff;
}
.gt_row {
  background-color: transparent !important; /*ignored*/
}

/* add spacing for figs and tables, so text and other figs/tables don't 
start right up at their border */
.l-body {
  margin-top: 20px;
  margin-bottom: 20px;
}

/* Search bar */

.algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: #fffff8;
    color: #15b7d6;             /* Color of text in drop-down*/
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 0px #15b7d6 solid;  /* Removed border */
    width: 180px;
}
</style>
<!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="../../styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Mô hình hỗn hợp (Mixed-effects model) I","description":"Mô hình hỗn hợp (Mixed-effects model) I","authors":[{"author":"Bùi Tuấn Anh","authorURL":"https://bui-tuananh.github.io","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-07-21T00:00:00.000+02:00","citationText":"Anh, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img alt="Logo"/>
</a>
<a href="../../index.html" class="title">Bui Tuan Anh</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../about.html">About</a>
<a href="../../documents.html">Documents</a>
<a href="../../workshops.html">Workshops</a>
<a href="../../code.html">Code</a>
<a href="../../resources.html">Resources</a>
<a href="https://github.com/bui-tuananh">
<i class="fab fa-github-alt fa-1x" aria-hidden="true"></i>
</a>
<a href="../../index.xml">
<i class="fa fa-rss fa-1x" aria-hidden="true"></i>
</a>
<span class="nav-dropdown-header"></span>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Mô hình hỗn hợp (Mixed-effects model) I</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Mô hình hỗn hợp (Mixed-effects model) I</p></p>
</div>

<div class="d-byline">
  Bùi Tuấn Anh <a href="https://bui-tuananh.github.io" class="uri">https://bui-tuananh.github.io</a> 
  
<br/>2024-07-21
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#giới-thiệu" id="toc-giới-thiệu">Giới thiệu</a></li>
<li><a href="#mô-hình-hỗn-hợp" id="toc-mô-hình-hỗn-hợp">Mô hình hỗn hợp</a></li>
<li><a href="#mô-hình-hỗn-hợp-tuyến-tính-trong-r" id="toc-mô-hình-hỗn-hợp-tuyến-tính-trong-r">Mô hình hỗn hợp tuyến tính trong R</a>
<ul>
<li><a href="#khám-phá-dữ-liệu" id="toc-khám-phá-dữ-liệu">Khám phá dữ liệu</a></li>
<li><a href="#phân-tích-dữ-liệu" id="toc-phân-tích-dữ-liệu">Phân tích dữ liệu</a></li>
</ul></li>
<li><a href="#kết-luận" id="toc-kết-luận">Kết luận</a></li>
<li><a href="#phụ-lục" id="toc-phụ-lục">Phụ lục</a>
<ul>
<li><a href="#code-giả-lập-dữ-liệu" id="toc-code-giả-lập-dữ-liệu">Code giả lập dữ liệu</a></li>
<li><a href="#thuật-ngữ-sử-dụng-trong-bài" id="toc-thuật-ngữ-sử-dụng-trong-bài">Thuật ngữ sử dụng trong bài</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="giới-thiệu">Giới thiệu</h2>
<p>Trong sinh thái học, các dữ liệu thu thập từ thực địa thường không hoàn
toàn độc lập (có yếu tố phụ thuộc). Ví dụ, nếu chúng ta thu thập dữ liệu
của các cá thể ở các quần thể khác nhau thì số liệu sẽ có yếu tố phụ
thuộc ở cấp quần thể, dữ liệu từ các cá thể từ cùng một quần thể sẽ có
giá trị tương đồng nhau. Một ví dụ khác ở cấp cá thể là khi ta thu thập
dữ liệu ở những mốc thời gian khác nhau từ cùng một cá thể thì những dữ
liệu này sẽ có giá trị tương đồng nhau so với những dữ liệu từ một cá
thể khác. Với những dữ liệu không độc lập (có yếu tố phụ thuộc) thì việc
áp dụng mô hình hồi quy (regression models) sẽ vi phạm giả thuyết về
tính độc lập của dữ liệu và dẫn đến sai lệch trong kết quả ước lượng. Để
phân tích những dữ liệu không độc lập (có yếu tố phụ thuộc), mà chúng ta
thường thấy trong sinh thái học, thì một trong những công cụ hiệu quả và
được sử dụng phổ biến là mô hình hỗn độn (mixed-effects models).</p>
<p>Trong bài viết này, mình sẽ giới thiệu về (1) mô hình hỗn hợp và (2)
cách sử dụng một mô hình hỗn hợp tuyến tính (linear mixed-effects
models) trong R. Mình sẽ sử dụng dữ liệu giả lập để đảm bảo mô hình mình
sử dụng có đúng cấu trúc với dữ liệu.</p>
<h2 id="mô-hình-hỗn-hợp">Mô hình hỗn hợp</h2>
<p>Mô hình hỗn hợp gồm ba thành phần: <strong>ảnh hưởng cố định</strong> (fixed
effects), <strong>ảnh hưởng ngẫu nhiên</strong> (random effects), và <strong>sai số ngẫu
nhiên</strong> (random error)</p>
<p><span class="math display">\[y = \alpha + \beta_1x_1 + \dots + \beta_nx_n + (a^a + \dots + a^z + b^ax_1 + \dots + b^zx_n + f(.)) + \varepsilon\]</span></p>
<p>trong đó:</p>
<ul>
<li><p><strong>ảnh hưởng cố định</strong> là <span class="math inline">\(\alpha + \beta_1x_1 + \dots + \beta_nx_n\)</span></p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> là hệ số chặn (intercept)</p></li>
<li><p><span class="math inline">\(\beta\)</span> là hệ số hồi quy hoặc hệ số dốc (slope) của mỗi ảnh
hưởng cố định <span class="math inline">\(x\)</span> (từ 1 đến n)</p></li>
</ul></li>
<li><p><strong>ảnh hưởng ngẫu nhiên</strong> là
<span class="math inline">\((a^a + \dots + a^z + b^ax_1 + \dots + b^zx_n + f(.))\)</span></p>
<ul>
<li><p><span class="math inline">\(a\)</span> là hệ số chặn ngẫu nhiên (random intercept) của mỗi cấp phụ
thuộc (từ a đến z)</p></li>
<li><p><span class="math inline">\(b\)</span> là hệ số hồi quy ngẫu nhiên (random slope) của mỗi cấp phụ
thuộc (từ a đến z)</p></li>
<li><p><span class="math inline">\(f(.)\)</span> là các hiệu ứng ngẫu nhiên khác như không gian hoặc thời
gian</p></li>
<li><p>lưu ý 1: <span class="math inline">\(a\)</span> và <span class="math inline">\(b\)</span> được giả định là tuân theo phân bố chuẩn với
giá trị trung bình (mean) 0 và phương sai (variance)
<span class="math inline">\(\sigma_a^2\)</span> và <span class="math inline">\(\sigma_b^2\)</span> (<span class="math inline">\(\sigma_a\)</span> và <span class="math inline">\(\sigma_b\)</span> là độ
lệch chuẩn (standard deviation) của <span class="math inline">\(a\)</span> và <span class="math inline">\(b\)</span>); còn được ký
hiệu là <span class="math inline">\(a\)</span> ~ <span class="math inline">\(N(0,\sigma_a^2)\)</span> và <span class="math inline">\(b\)</span> ~ <span class="math inline">\(N(0,\sigma_b^2)\)</span></p></li>
<li><p>lưu ý 2: ảnh hưởng ngẫu nhiên chỉ có thể là biến phân loại
(categorical variable), ví dụ như quần thể, khu vực, cá thể</p></li>
<li><p>lưu ý 3: ảnh hưởng ngẫu nhiên có thể chỉ bao gồm một trong số
các thành phần trên hoặc bao gồm tổ hợp của các thành phần khác
nhau tùy thuộc vào cấu trúc của dữ liệu</p></li>
</ul></li>
<li><p><strong>sai số ngẫu nhiên</strong> là <span class="math inline">\(\varepsilon\)</span></p>
<ul>
<li><span class="math inline">\(\varepsilon\)</span> được giả định là tuân theo phân bố chuẩn với giá
trị trung bình 0 và phương sai <span class="math inline">\(\sigma_{\varepsilon}^2\)</span>;
<span class="math inline">\(\varepsilon\)</span> ~ <span class="math inline">\(N(0,\sigma_b^2)\)</span></li>
</ul></li>
</ul>
<p>Ảnh hưởng cố định mô tả mối liên hệ giữa biến phụ thuộc <span class="math inline">\(y\)</span> (response
variable) và (các) biến giải thích (explanatory variables) <span class="math inline">\(x\)</span>. Ví dụ,
giả sử chiều dài cơ thể cá (biến phụ thuộc <span class="math inline">\(y\)</span>, đơn vị cm) có liên hệ
với nhiệt độ môi trường (biến giải thích <span class="math inline">\(x\)</span>, đơn vị <span class="math inline">\(^\circ\)</span>C ) theo
công thức <span class="math inline">\(y\)</span> = 100 - 5<span class="math inline">\(x\)</span> (<span class="math inline">\(\alpha\)</span> = 100, <span class="math inline">\(\beta\)</span> = -5), nghĩa là ở
nhiệt độ 0 <span class="math inline">\(^\circ\)</span>C (<span class="math inline">\(x\)</span> = 0) chiều dài trung bình của cá là 100 cm và
mỗi khi nhiệt độ tăng một 1 <span class="math inline">\(^\circ\)</span>C thì chiều dài trung bình của cá
giảm 5 cm. Phần ảnh hưởng cố định cũng thể hiện giá trị ước lượng</p>
<p>Ảnh hưởng ngẫu nhiên mô tả cấu trúc phụ thuộc của mô hình. Ví dụ, giả sử
chúng ta thu thập dữ liệu chiều dài cơ thể cá từ 5 quần thể khác nhau
(chỉ có một cấp phụ thuộc là quần thể) với <span class="math inline">\(a\)</span> của 5 quần thể là (-3,3,
13,6, -4,7, -8,4, -14,6). Mỗi quần thể có một công thức mối liên hệ giữa
giữa chiều dài cơ thể cá và nhiệt độ môi trường như sau:</p>
<ul>
<li><p>Quần thể 1: <span class="math inline">\(y = 100 - 5x + (-3.3)\)</span></p></li>
<li><p>Quần thể 2: <span class="math inline">\(y = 100 - 5x + (13.6)\)</span></p></li>
<li><p>Quần thể 3: <span class="math inline">\(y = 100 - 5x + (-4.1)\)</span></p></li>
<li><p>Quần thể 4: <span class="math inline">\(y = 100 - 5x + (-8.4)\)</span></p></li>
<li><p>Quần thể 5: <span class="math inline">\(y = 100 - 5x + (-14.6)\)</span></p></li>
</ul>
<p>nghĩa là chiều dài trung bình của cá ở các quần thể từ 1 đến 5 lần lượt
cao hơn hoặc thấp hơn -3,3, 13,6, -4,7, -8,4, -14,6 cm so với chiều dài
trung bình của cá ước lượng cho tất cả các quan sát trong bộ dữ liệu
(phần ảnh hưởng cố định).</p>
<p>Sai số ngẫu nhiên mô tả sự khác biệt giữa giá trị quan sát (chiều dài
của từng cá thể cá) và giá trị ước lượng (chiều dài trung bình cá ước
lượng cho từng quần thể theo công thức <span class="math inline">\(y\)</span> = 100 - 5<span class="math inline">\(x\)</span> + <span class="math inline">\(a\)</span> với <span class="math inline">\(a\)</span>
của 5 quần thể là (-3,3, 13,6, -4,7, -8,4, -14,6).</p>
<p>Để dễ hình dung, chúng ta có thể xem Hình <a href="#fig:fig1">1</a>. Trong đó:</p>
<ul>
<li><p>đường đậm màu đen thể hiện mối liên hệ giữa chiều dài cơ thể cá và
nhiệt độ ước lượng cho tất cả cá quan sất trong bộ dữ liệu (phần
<strong>ảnh hưởng cố định</strong> <span class="math inline">\(y\)</span> = 100 - 5<span class="math inline">\(x\)</span>)</p></li>
<li><p>đường nét đứt kéo dài từ đường đậm màu đen thể hiện hệ số chặn
<span class="math inline">\(\alpha\)</span> = 100 khi <span class="math inline">\(x\)</span> = 0</p></li>
<li><p>các đường có màu thể hiện mối liên hệ giữa chiều dài cơ thể cá và
nhiệt độ ước lượng cho từng quần thể (<span class="math inline">\(y\)</span> = 100 - 5<span class="math inline">\(x\)</span> + <span class="math inline">\(a\)</span> với <span class="math inline">\(a\)</span>
là phần <strong>ảnh hưởng ngẫu nhiên</strong> của 5 quần thể với giá trị (-3,3,
13,6, -4,7, -8,4, -14,6)).</p></li>
<li><p>các điểm có màu thể hiện giá trị chiều dài cơ thể cá và nhiệt độ
quan sát được</p></li>
<li><p>các đường nét chấm thể hiện sự khác biệt giữa giá trị quan sát và
giá trị ước lượng (phần <strong>sai số ngẫu nhiên</strong>)</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig1"></span>
<img src="2024-07-21-mixed-model-intercept_files/figure-html5/fig1-1.svg" alt="Biểu đồ mô tả các thành phần của mô hình hỗn hợp" width="624" />
<p class="caption">
Hình 1: Biểu đồ mô tả các thành phần của mô hình hỗn hợp
</p>
</div>
</div>
<h2 id="mô-hình-hỗn-hợp-tuyến-tính-trong-r">Mô hình hỗn hợp tuyến tính trong R</h2>
<p>Ở phần này mình sẽ giới thiệu cách sử dụng một mô hình hỗn hợp tuyến
tính (linear mixed-effects models) trong R. Mình sẽ sử dụng dữ liệu giả
lập để đảm bảo mô hình mình sử dụng có đúng cấu trúc với dữ liệu (phần
code để giả lập dữ liệu ở phía cuối của mục này).</p>
<p>Trước khi bắt đầu, chúng ta sẽ tải các thư viện để giúp cho việc code dễ
dàng hơn</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Thiết lập ban đầu</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span> <span class='co'># bộ thư viện để xử lý, trực quan hóa dữ liệu</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/glmmTMB/glmmTMB'>glmmTMB</a></span><span class='op'>)</span>   <span class='co'># thư viện để chạy mô hình hỗn hợp</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glin.github.io/reactable/'>reactable</a></span><span class='op'>)</span> <span class='co'># thư viện để hỗ trợ hiển thị bảng </span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span> <span class='co'># thư viện để hỗ trợ việc hiển thị biểu đồ </span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># đặt nền của biểu đồ theo kiểu theme_bw()</span></span>
<span></span>
<span><span class='co'># hàm kable_df để trình bày bảng</span></span>
<span><span class='va'>kable_df</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>digits</span><span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>...</span>, digits<span class='op'>=</span><span class='va'>digits</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>full_width <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</div>
<h3 id="khám-phá-dữ-liệu">Khám phá dữ liệu</h3>
<p>Giả sử chúng ta thu thập dữ liệu chiều dài cơ thể cá ở 5 quần thể khác
nhau. Ở mỗi quần thể, chúng ta thu thập dữ liệu của 100 cá thể cá. Do
chúng ta muốn nghiên cứu mối quan hệ giữa nhiệt độ và chiều dài cơ thể
cá nên với mỗi quan sát, chúng ta cũng đo nhiệt độ môi trường tại thời
điểm thu thập dữ liệu. Dữ liệu thu thập như ở bảng sau:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># df là dữ liệu giả lập đã được tạo trước</span></span>
<span><span class='co'># pop_name (quần thể), temp (nhiệt độ), và length (chiều dài cơ thể cá)</span></span>
<span><span class='co'># các giá trị được làm tròn đến 1 đơn vị thập phân </span></span>
<span></span>
<span><span class='fu'><a href='https://glin.github.io/reactable/reference/reactable.html'>reactable</a></span><span class='op'>(</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>temp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>temp</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>           length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>length</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-248994c544a72f4308f7" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-248994c544a72f4308f7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pop_name":["Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 1","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 2","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 3","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 4","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5","Quần thể 5"],"temp":[2.5,3.1,2.9,3.9,3.1,3.3,2.4,3.7,2.2,2.6,3.1,3.1,2.8,3.7,3.1,3,2.6,3.5,2.1,5.3,2.6,3.8,3.3,3.8,2.2,2.6,2.3,3.2,1.8,3.2,2.9,4.8,2.9,2.9,2.3,2.8,3.2,3.4,4.1,4,2.9,4.4,1.2,3.6,2.5,4.3,2.6,4.3,3,1.1,2.6,1.3,3.2,4.9,0.7,4,1.6,4.8,4.4,2.2,2.7,2.9,2.6,5.6,3.1,2.3,3.6,3.2,2.9,2.9,3.4,1.9,1.8,4.6,0.9,3,1.9,3.3,4,0.9,3.9,3,1.7,1.1,3.7,2.8,3.2,3.8,4.7,2.9,2.4,4.4,2.1,1.8,2.5,5.4,2.2,3.4,1.8,1.8,2.5,3.1,2.9,3.9,3.1,3.3,2.4,3.7,2.2,2.6,3.1,3.1,2.8,3.7,3.1,3,2.6,3.5,2.1,5.3,2.6,3.8,3.3,3.8,2.2,2.6,2.3,3.2,1.8,3.2,2.9,4.8,2.9,2.9,2.3,2.8,3.2,3.4,4.1,4,2.9,4.4,1.2,3.6,2.5,4.3,2.6,4.3,3,1.1,2.6,1.3,3.2,4.9,0.7,4,1.6,4.8,4.4,2.2,2.7,2.9,2.6,5.6,3.1,2.3,3.6,3.2,2.9,2.9,3.4,1.9,1.8,4.6,0.9,3,1.9,3.3,4,0.9,3.9,3,1.7,1.1,3.7,2.8,3.2,3.8,4.7,2.9,2.4,4.4,2.1,1.8,2.5,5.4,2.2,3.4,1.8,1.8,2.5,3.1,2.9,3.9,3.1,3.3,2.4,3.7,2.2,2.6,3.1,3.1,2.8,3.7,3.1,3,2.6,3.5,2.1,5.3,2.6,3.8,3.3,3.8,2.2,2.6,2.3,3.2,1.8,3.2,2.9,4.8,2.9,2.9,2.3,2.8,3.2,3.4,4.1,4,2.9,4.4,1.2,3.6,2.5,4.3,2.6,4.3,3,1.1,2.6,1.3,3.2,4.9,0.7,4,1.6,4.8,4.4,2.2,2.7,2.9,2.6,5.6,3.1,2.3,3.6,3.2,2.9,2.9,3.4,1.9,1.8,4.6,0.9,3,1.9,3.3,4,0.9,3.9,3,1.7,1.1,3.7,2.8,3.2,3.8,4.7,2.9,2.4,4.4,2.1,1.8,2.5,5.4,2.2,3.4,1.8,1.8,2.5,3.1,2.9,3.9,3.1,3.3,2.4,3.7,2.2,2.6,3.1,3.1,2.8,3.7,3.1,3,2.6,3.5,2.1,5.3,2.6,3.8,3.3,3.8,2.2,2.6,2.3,3.2,1.8,3.2,2.9,4.8,2.9,2.9,2.3,2.8,3.2,3.4,4.1,4,2.9,4.4,1.2,3.6,2.5,4.3,2.6,4.3,3,1.1,2.6,1.3,3.2,4.9,0.7,4,1.6,4.8,4.4,2.2,2.7,2.9,2.6,5.6,3.1,2.3,3.6,3.2,2.9,2.9,3.4,1.9,1.8,4.6,0.9,3,1.9,3.3,4,0.9,3.9,3,1.7,1.1,3.7,2.8,3.2,3.8,4.7,2.9,2.4,4.4,2.1,1.8,2.5,5.4,2.2,3.4,1.8,1.8,2.5,3.1,2.9,3.9,3.1,3.3,2.4,3.7,2.2,2.6,3.1,3.1,2.8,3.7,3.1,3,2.6,3.5,2.1,5.3,2.6,3.8,3.3,3.8,2.2,2.6,2.3,3.2,1.8,3.2,2.9,4.8,2.9,2.9,2.3,2.8,3.2,3.4,4.1,4,2.9,4.4,1.2,3.6,2.5,4.3,2.6,4.3,3,1.1,2.6,1.3,3.2,4.9,0.7,4,1.6,4.8,4.4,2.2,2.7,2.9,2.6,5.6,3.1,2.3,3.6,3.2,2.9,2.9,3.4,1.9,1.8,4.6,0.9,3,1.9,3.3,4,0.9,3.9,3,1.7,1.1,3.7,2.8,3.2,3.8,4.7,2.9,2.4,4.4,2.1,1.8,2.5,5.4,2.2,3.4,1.8,1.8],"length":[83.8,80.2,81.7,78.5,81,80.3,84.8,77.5,84.4,83.1,81.3,82.2,82.4,77.7,82.7,81,84,78.5,86.7,68.6,83.3,77.6,81.4,77.3,86,83.4,84.4,81.2,87,81.8,82.6,72.7,82.8,82.2,85.6,82.4,78.6,79.7,77,75.8,81.1,74.2,90,79,84.4,76.1,85.1,75.1,81.4,91.3,83.6,90.3,80.7,72.4,93.2,76.5,88.7,72.4,75.6,85.9,82.4,81.8,82.9,69,81.9,85.9,78.7,80.6,82.3,82.1,77.4,87.4,87.1,74.7,94.1,80.4,87.7,80.4,76.1,92.7,77.9,81.8,88.1,90.2,77.5,82.2,80.3,78.5,72.8,84.1,84,76.1,86.3,86.4,84.9,69.5,85.5,80.5,88.1,88.6,100.1,97.4,98,91.2,98.4,98.3,102.2,93.7,101.9,98.6,99.4,97.8,98.7,95.8,97.8,97.3,100.6,96.1,103.4,87.5,100.2,95.4,96.1,96.1,102.1,101.3,102.8,97.2,102.8,97.1,98.5,89.5,100.2,99.9,102.3,99,100.3,94.9,91.7,94.1,101.9,91.3,106.3,95.1,103.8,91.2,99.9,91.8,99.2,108.7,100.4,105.4,99.6,87.9,109.5,93.9,106,88.3,92,103.7,100.4,99.8,99.6,85.6,99.1,102.7,95.8,98.7,98.5,99.7,95.6,103.7,104.6,91,106.3,99.7,104.5,98.6,94.7,109.7,94.3,99.5,105.3,108.9,95.4,100.3,96.9,94.2,90.4,98,101,91.8,104.9,105.2,100,84.5,101.8,95.5,103.9,104.9,83.9,79.8,81.1,74,80.2,79.6,82.4,76.2,84.2,81.6,80.2,79.2,80.9,75.9,80.5,79.2,83.1,78,84.8,69,85,77,80.3,77.1,84.2,81.1,85.1,79.5,86.6,79.5,80.5,71.2,80.3,78.5,82.2,83.2,77,78.6,75.5,74.4,81.8,72.8,89.2,78.6,82.5,73.6,83.4,73.6,79.7,90.8,82.1,90.4,79.1,71.4,89,74,90.6,72,74.6,84.8,81.6,78,82.3,66.9,81,83.5,78.5,80,81.4,80,76.2,86.1,86.6,70.5,90.5,79.9,85.8,78.3,75,89.5,76.8,80.1,86.4,90.6,76.7,80.6,80.6,77.2,70.5,80.3,84.1,71.5,83.7,84.9,81.8,66.8,84.3,79.7,85.2,85.2,97,90.8,92.8,89.8,93.5,92.9,96.5,91.4,97.3,95.1,92.6,93.3,92.4,89.6,91.9,93.9,96.2,90.4,98.6,82.1,96.7,89,90.4,90.2,97.3,96.3,97,93.3,98.6,92.4,94.5,84,95,95.1,94.5,93.8,92.5,93.1,87,89.7,95.2,85.4,102.1,90.2,96.4,84.9,91.9,87.8,93.2,102.6,96,102.3,93.5,81.7,103,90.2,98.8,82.6,86.5,97.7,93.3,93.4,95.9,79.9,92.7,98.3,89.5,93,92.1,93.4,93.2,99.2,100.2,86.5,103.6,93.4,100,92.3,87.3,103.3,89.3,93.5,99.5,103.1,89.6,95.5,92.2,90.6,83.7,93.5,94.5,86.3,97.3,96.7,95.4,79.8,97.9,91,97.4,99.5,72.6,72.2,71.4,65.4,70.2,68.8,73.8,69.1,74,72.8,71.2,69,70.1,66.4,69.9,70.9,72.9,66.9,76.7,60.5,71.6,67,69.5,65.7,75.3,72.7,76.3,68,75.1,70.7,70.6,62.3,69.9,72.1,74.3,72.3,68.8,68.8,65.2,65.9,71.2,64.1,78.8,69,72.2,62.8,72.8,63.9,69.2,80,72.4,78.1,69.9,62.5,83,68.4,78.1,60.6,63.3,75.3,70.7,69.8,71.4,57.7,70.1,73.3,67.1,71.1,70.3,70.4,69.5,75.8,76.8,63.7,81.6,70.9,75.6,68.3,66.3,80,66.3,70.1,77.1,80.9,67.1,70.8,69,68,58.9,71.6,71,63,74,75.9,75.6,60.1,74.6,67.1,77.1,77.1]},"columns":[{"id":"pop_name","name":"pop_name","type":"character"},{"id":"temp","name":"temp","type":"numeric"},{"id":"length","name":"length","type":"numeric"}],"dataKey":"8e8a627e01e1e7523a530219b817979f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Ta sẽ kiểm tra phân bố của chiều dài cơ thể cá (biến phụ thuộc <span class="math inline">\(y\)</span>) và
mối liên hệ của chiều dài cơ thể cá và nhiệt độ (biến giải thích <span class="math inline">\(x\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># phân bố chiều dài cơ thể cá</span></span>
<span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>length</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># chiều dài cơ thể cá ~ nhiệt độ</span></span>
<span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length</span>, color <span class='op'>=</span> <span class='va'>pop_name</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Nhiệt độ (\u00b0C)"</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Chiều dài cơ thể cá (cm)"</span>,</span>
<span>       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># gộp hai biểu đồ </span></span>
<span><span class='op'>(</span><span class='va'>p1</span> <span class='op'>|</span> <span class='va'>p2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>tag_levels <span class='op'>=</span> <span class='st'>"A"</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig2"></span>
<img src="2024-07-21-mixed-model-intercept_files/figure-html5/fig2-1.svg" alt="Phân bố của chiều dài cơ thể cá (A) và mối liên hệ giữa chiều dài cơ thể cá và nhiệt độ (B)" width="624" />
<p class="caption">
Hình 2: Phân bố của chiều dài cơ thể cá (A) và mối liên hệ giữa chiều dài cơ thể cá và nhiệt độ (B)
</p>
</div>
</div>
<p>Về phân bố (Hình <a href="#fig:fig2">2</a>A), chúng ta có thể giả định chiều dài
của cá tuân theo phân bố chuẩn. Về mối liên hệ giữa chiều dài cơ thể cá
và nhiệt độ (Hình <a href="#fig:fig2">2</a>B), chúng ta có thể thấy hai điều: (1)
chiều dài cơ thể cá có mối mối liên hệ nghịch với nhiệt độ với chiều dài
cơ thể cá giảm khi nhiệt độ tăng; (2) ở cùng một nhiệt độ nhất định thì
chiều dài cơ thể cá khác nhau giữa các quần thể.</p>
<p>Nếu bạn thấy hình <a href="#fig:fig2">2</a>B quen thì chính xác vì là cùng dữ liệu
sử dụng ở hình <a href="#fig:fig2">2</a>. Nếu bạn quay lại mục trước thì bạn sẽ
biết được kết quả của mối liên hệ giữa chiều dài cơ thể cá và nhiệt độ
cũng như sự khác biệt giữa 5 quần thể. Tuy nhiên, tạm thời chúng ta sẽ
coi như chưa biết gì và cùng thử phân tích dữ liệu này.</p>
<h3 id="phân-tích-dữ-liệu">Phân tích dữ liệu</h3>
<p>Sau khi khám phá dữ liệu thì chúng ta có thể quyết định sử dụng một mô
hình hỗn hợp như sau:</p>
<p><span class="math display">\[y = \alpha + \beta x + a + \varepsilon\]</span></p>
<p>trong đó <span class="math inline">\(\alpha\)</span> là hệ số chặn thể hiện chiều dài cá trung bình khi
nhiệt độ (<span class="math inline">\(x\)</span>) bằng 0 <span class="math inline">\(^\circ\)</span>C; <span class="math inline">\(\beta\)</span> là hệ số hồi quy thể hiện mối
quan hệ giữa chiều dài cá và nhiệt độ; <span class="math inline">\(a\)</span> là hệ số chặn ngẫu nhiên thể
hiện sự khác biệt về chiều dài cá trung bình giữa 5 quần thể với
<span class="math inline">\(\alpha\)</span> (mỗi một quần thể sẽ có một giá trị <span class="math inline">\(a\)</span>), <span class="math inline">\(a\)</span> ~
<span class="math inline">\(N(0,\sigma_a^2)\)</span> ; <span class="math inline">\(\varepsilon\)</span> là sai số ngẫu nhiên, <span class="math inline">\(\varepsilon\)</span> ~
<span class="math inline">\(N(0,\sigma_{\varepsilon}^2)\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># công thức mô hình hỗn hợp với thư viện glmmTMB</span></span>
<span></span>
<span><span class='va'>lme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html'>glmmTMB</a></span><span class='op'>(</span><span class='va'>length</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>temp</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>pop_name</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>df</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Kết quả ước lượng của mô hình như sau:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> Family: gaussian  ( identity )
Formula:          length ~ 1 + temp + (1 | pop_name)
Data: df

     AIC      BIC   logLik deviance df.resid 
  1484.0   1500.9   -738.0   1476.0      496 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 pop_name (Intercept) 98.774   9.939   
 Residual              1.023   1.011   
Number of obs: 500, groups:  pop_name, 5

Dispersion estimate for gaussian family (sigma^2): 1.02 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 99.84933    4.44689   22.45   &lt;2e-16 ***
temp        -4.98876    0.04453 -112.03   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>Phần chúng ta cần quan tâm là (theo thứ tự từ dưới liên trên của kết quả
summary()) là <strong>Conditional model</strong> (ảnh hưởng cố định) và <strong>Random
effects</strong> (ảnh hưởng ngẫu nhiên).</p>
<p>Đối với ảnh hưởng cố định trong phần <strong>Conditional model</strong>:</p>
<ul>
<li><p>dòng (Intercept) thể hiện hệ số chặn <span class="math inline">\(\alpha\)</span> là 99.9</p></li>
<li><p>dòng temp thể hiện hệ số hồi quy <span class="math inline">\(\beta\)</span> là -5.0</p></li>
</ul>
<p>Đối với ảnh hưởng ngẫu nhiên trong phần <strong>Random effects</strong>:</p>
<ul>
<li><p>dòng pop_name (Intercept) thể hiện phương sai <span class="math inline">\(\sigma_a^2\)</span>
(variance) và độ lệch chuẩn <span class="math inline">\(\sigma_a\)</span> (standard deviation) của hệ
số chặn ngẫu nhiên <span class="math inline">\(a\)</span></p></li>
<li><p>dòng Residual thể hiện phương sai <span class="math inline">\(\sigma_{\varepsilon}^2\)</span>
(variance) và độ lệch chuẩn <span class="math inline">\(\sigma_{\varepsilon}\)</span> (standard
deviation) của sai số ngẫu nhiên <span class="math inline">\(\varepsilon\)</span></p></li>
</ul>
<p>Phần kết quả ảnh hưởng cố định thì đã rõ ràng nhưng phần kết quả ảnh
hưởng ngẫu nhiên từ summary() chưa cho chúng ta biết giá trị <span class="math inline">\(a\)</span> của
từng quần thể là bao nhiêu. Chúng ta có thể lấy kết quả của <span class="math inline">\(a\)</span> như sau:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># lấy kết quả cho hệ số chặn ngẫu nhiên (1 | pop_name) và làm tròn kết quả đến 2 đơn vị </span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/nlme/man/random.effects.html'>ranef</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cond</span><span class='op'>$</span><span class='va'>pop_name</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"$a$"</span> <span class='op'>=</span> <span class='va'>`(Intercept)`</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>kable_df</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(a\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Quần thể 1
</td>
<td style="text-align:right;">
-3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 2
</td>
<td style="text-align:right;">
13.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 3
</td>
<td style="text-align:right;">
-4.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 4
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 5
</td>
<td style="text-align:right;">
-14.3
</td>
</tr>
</tbody>
</table>
</div>
<p>Tổng hợp các kết quả từ mô hình hỗn hợp như sau:</p>
<ul>
<li><p>hệ số chặn <span class="math inline">\(\alpha\)</span> là 99.9, nghĩa là ở nhiệt độ 0 <span class="math inline">\(^\circ\)</span>C chiều
dài cá trung bình là 99,9 cm</p></li>
<li><p>hệ số hồi quy <span class="math inline">\(\beta\)</span> là -5.0, nghĩa là khi nhiệt độ tăng 1
<span class="math inline">\(^\circ\)</span>C thì chiều dài cá giảm -5,0 cm</p></li>
<li><p>hệ số chặn ngẫu nhiên <span class="math inline">\(a\)</span> của 5 quần thể 1-5 là -3,2, 13,7, -4,6,
8,4, -14,3, nghĩa là chiều dài trung bình của cá ở các quần thể từ 1
đến 5 lần lượt cao hơn hoặc thấp hơn -3,2, 13,7, -4,6, 8,4, -14,3 cm
so với chiều dài trung bình của cá ước lượng cho tất cả các quan sát
trong bộ dữ liệu; <span class="math inline">\(a\)</span> phân bố với phương sai <span class="math inline">\(\sigma_a^2\)</span> = 50,9 (độ
lệch chuẩn <span class="math inline">\(\sigma_a\)</span> = 7,1)</p></li>
<li><p>sai số ngẫu nhiên <span class="math inline">\(\varepsilon\)</span> phân bố với phương sai
<span class="math inline">\(\sigma_{\varepsilon}^2\)</span> = 1,0 (độ lệch chuẩn <span class="math inline">\(\sigma_{\varepsilon}\)</span>
= 1,0)</p></li>
</ul>
<p>Để dễ hình dung thì ta sẽ trực quan hóa kết quả phân tích. Chúng ta cũng
so sánh kết quả này với giá trị của các tham số được sử dụng khi giả lập
dữ liệu để xem các kết quả có chính xác không.</p>
<p>Hình <a href="#fig:fig3">3</a> thể hiện kết quả phân tích (đường liền mờ) và giá
trị giả lập (đường nét đứt). Đường màu đen thể hiện mối liên hệ giữ
chiều dài cơ thể cá và nhiệt độ cho toàn bộ quan sát. Các đường có màu
thể hiện mối liên hệ cho từng quần thể. Các điểm có màu là giá trị chiều
dài cơ thể cá và nhiệt độ quan sát được.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df_pred</span> <span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>length_fixed_pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/nlme/man/fixed.effects.html'>fixef</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cond</span><span class='op'>[</span><span class='st'>"(Intercept)"</span><span class='op'>]</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/nlme/man/fixed.effects.html'>fixef</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cond</span><span class='op'>[</span><span class='st'>"temp"</span><span class='op'>]</span><span class='op'>*</span><span class='va'>temp</span>,</span>
<span>         length_pop_pred <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span>,</span>
<span>         length_res <span class='op'>=</span> <span class='va'>length</span> <span class='op'>-</span> <span class='va'>length_pop_pred</span><span class='op'>)</span> <span class='co'>#có thể dùng lenght_res = resid(lme)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># obs</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_pred</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length</span>, color <span class='op'>=</span> <span class='va'>pop_name</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># fixed effect</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_pred</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length_fixed_pred</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_sim</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length_fixed_pred</span><span class='op'>)</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'># random effect</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_pred</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length_pop_pred</span>, color <span class='op'>=</span> <span class='va'>pop_name</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_sim</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>temp</span>, y <span class='op'>=</span> <span class='va'>length_pop_pred</span>, color <span class='op'>=</span> <span class='va'>pop_name</span><span class='op'>)</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Nhiệt độ (\u00b0C)"</span>,</span>
<span>       y <span class='op'>=</span> <span class='st'>"Chiều dài cơ thể cá (cm)"</span>,</span>
<span>       color <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span></code></pre>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig3"></span>
<img src="2024-07-21-mixed-model-intercept_files/figure-html5/fig3-1.svg" alt="Trực quan hóa các kết quả phân tích mối liên hệ giữa chiều dài cơ thể cá và nhiệt độ" width="624" />
<p class="caption">
Hình 3: Trực quan hóa các kết quả phân tích mối liên hệ giữa chiều dài cơ thể cá và nhiệt độ
</p>
</div>
</div>
<p>Kết quả phân tích trùng với giá trị giả lập do các đường liền mờ và các
đường nét đứt gần như trùng khớp hoàn toàn. Ta có thể thấy sự trùng khớp
này rõ hơn khi so sánh các tham số ước lượng và giả lập.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lme_sum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span></span>
<span>  </span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>`Tham số` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"$\\alpha$"</span>, <span class='st'>"$\\beta$"</span>, <span class='st'>"$\\sigma_a$"</span>, <span class='st'>"$\\sigma_{\\varepsilon}$"</span><span class='op'>)</span>,</span>
<span>       `Giá trị uớc lượng` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/nlme/man/fixed.effects.html'>fixef</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cond</span>, <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>lme_sum</span><span class='op'>$</span><span class='va'>varcor</span><span class='op'>$</span><span class='va'>cond</span><span class='op'>$</span><span class='va'>pop_name</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, <span class='va'>lme_sum</span><span class='op'>$</span><span class='va'>sigma</span><span class='op'>)</span>,</span>
<span>       `Giá trị giả lập` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>kable_df</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Tham số
</th>
<th style="text-align:right;">
Giá trị uớc lượng
</th>
<th style="text-align:right;">
Giá trị giả lập
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\alpha\)</span>
</td>
<td style="text-align:right;">
99.8
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\beta\)</span>
</td>
<td style="text-align:right;">
-5.0
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_a\)</span>
</td>
<td style="text-align:right;">
9.9
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_{\varepsilon}\)</span>
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/nlme/man/random.effects.html'>ranef</a></span><span class='op'>(</span><span class='va'>lme</span><span class='op'>)</span><span class='op'>$</span><span class='va'>cond</span><span class='op'>$</span><span class='va'>pop_name</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>`$a$ ước lượng` <span class='op'>=</span> <span class='va'>`(Intercept)`</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>`$a$ giả lập` <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>df_sim</span><span class='op'>$</span><span class='va'>random_int</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'>kable_df</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(a\)</span> ước lượng
</th>
<th style="text-align:right;">
<span class="math inline">\(a\)</span> giả lập
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Quần thể 1
</td>
<td style="text-align:right;">
-3.2
</td>
<td style="text-align:right;">
-3.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 2
</td>
<td style="text-align:right;">
13.7
</td>
<td style="text-align:right;">
13.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 3
</td>
<td style="text-align:right;">
-4.6
</td>
<td style="text-align:right;">
-4.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 4
</td>
<td style="text-align:right;">
8.4
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Quần thể 5
</td>
<td style="text-align:right;">
-14.3
</td>
<td style="text-align:right;">
-14.6
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="kết-luận">Kết luận</h2>
<p>Trong bài viết này mình đã thiệu về mô hình hỗn hợp và cách sử dụng một
mô hình hỗn hợp tuyến tính (linear mixed-effects models) trong R. Vì mục
tiêu của bài viết là giới thiệu về khái niệm mô hình hỗn hợp nên mình
dùng một ví dụ đơn giản với một hệ số chặn ngẫu nhiên <span class="math inline">\(a\)</span>. Ở các bài
viết sau mình sẽ giới thiệu các mô hình với cấu trúc phức tạp hơn (bao
gồm hệ số hồi quy ngẫu nhiên, ảnh hưởng không gian, và thời gian) để thể
hiện rõ hơn sự hiệu quả của mô hình hỗn hợp trong phân tích dữ liệu có
các yếu tố phụ thuộc phức tạp (ví dụ các quan sát từ cùng một quần thể,
cá thể, năm, hoặc khu vực) mà chúng ta thường gặp trong nghiên cứu sinh
thái học.</p>
<p>Để kết bài, mình sẽ đề cập đến một câu hỏi mà bất kỳ ai khi tiếp cận mô
hình hỗn hợp đều sẽ có đó là: “khi nào thì quyết định một biến phân loại
(ví dụ như giới tính, quần thể, cá thể, khu vực) là ảnh hưởng cố định
hay ảnh hưởng ngẫu nhiên”. Một quy tắc được nhắc đến nhiều trong các tài
liệu nghiên cứu là một biến phân loại nên được sử dụng là ảnh hưởng ngẫu
nhiên nếu có ít nhất 5 nhóm (ví dụ 5 quần thể trong biến quần thể), còn
không nên được sử dụng là ảnh hưởng cố định (ví dụ biến giới tính với 2
nhóm nam/nữ) <span class="citation" data-cites="gomes2022should">(<a href="#ref-gomes2022should" role="doc-biblioref">Gomes 2022</a>)</span>.</p>
<h2 id="phụ-lục">Phụ lục</h2>
<h3 id="code-giả-lập-dữ-liệu">Code giả lập dữ liệu</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#giá trị để các hàm ngẫu nhiên (rnorm) luôn trả kết quả giống nhau</span></span>
<span><span class='co'># đảm bảo tính lặp lại của đoạn code</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>n_pop</span> <span class='op'>=</span> <span class='fl'>5</span> <span class='co'>#số quần thể</span></span>
<span><span class='va'>df_sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>pop <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='va'>n_pop</span><span class='op'>)</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,</span>
<span>             pop_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Quần thể"</span>, <span class='va'>pop</span><span class='op'>)</span>,</span>
<span>             temp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, <span class='va'>n_pop</span><span class='op'>)</span>,</span>
<span>             length_fixed <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='fl'>5</span><span class='op'>*</span><span class='va'>temp</span>,</span>
<span>             random_int <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n_pop</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,</span>
<span>             length_pop <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='fl'>5</span><span class='op'>*</span><span class='va'>temp</span> <span class='op'>+</span> <span class='va'>random_int</span>, </span>
<span>             random_error <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n_pop</span><span class='op'>*</span><span class='fl'>100</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>             length <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='fl'>5</span><span class='op'>*</span><span class='va'>temp</span> <span class='op'>+</span> <span class='va'>random_int</span> <span class='op'>+</span> <span class='va'>random_error</span>,</span>
<span>             <span class='op'>)</span></span>
<span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>df_sim</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pop_name</span>, <span class='va'>temp</span>, <span class='va'>length</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="thuật-ngữ-sử-dụng-trong-bài">Thuật ngữ sử dụng trong bài</h3>
<table>
<thead>
<tr class="header">
<th>Tiếng Việt</th>
<th>Tiếng Anh</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dữ liệu độc lập</td>
<td>Independent data</td>
</tr>
<tr class="even">
<td>Dữ liệu có yếu tố phụ thuộc</td>
<td>Dependent data</td>
</tr>
<tr class="odd">
<td>Mô hình hồi quy</td>
<td>Regression model(s)</td>
</tr>
<tr class="even">
<td>Mô hình hỗn hợp</td>
<td>Mixed-effects model(s)</td>
</tr>
<tr class="odd">
<td>Mô hình hỗn hợp tuyến tính</td>
<td>Linear mixed-effects model(s)</td>
</tr>
<tr class="even">
<td>Cấu trúc mô hình</td>
<td>Model structure</td>
</tr>
<tr class="odd">
<td>Cấu trúc dữ liệu</td>
<td>Data structure</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-gomes2022should" class="csl-entry" role="listitem">
Gomes, Dylan GE. 2022. <span>“Should i Use Fixed Effects or Random Effects When i Have Fewer Than Five Levels of a Grouping Factor in a Mixed-Effects Model?”</span> <em>PeerJ</em> 10: e12794.
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=M%C3%B4%20h%C3%ACnh%20h%E1%BB%97n%20h%E1%BB%A3p%20%28Mixed-effects%20model%29%20I&amp;url=https%3A%2F%2Fbui-tuananh.github.io%2Fposts%2F2024-07-21-mixed-model-intercept%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fbui-tuananh.github.io%2Fposts%2F2024-07-21-mixed-model-intercept%2F&amp;title=M%C3%B4%20h%C3%ACnh%20h%E1%BB%97n%20h%E1%BB%A3p%20%28Mixed-effects%20model%29%20I" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fbui-tuananh.github.io%2Fposts%2F2024-07-21-mixed-model-intercept%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com//bui-tuananh/bui-tuananh.github.io/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. Source code is available at <a href="https://github.com//bui-tuananh/bui-tuananh.github.io">https://github.com//bui-tuananh/bui-tuananh.github.io</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Anh (2024, July 21). Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I. Retrieved from https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{anh2024mô,
  author = {Anh, Bùi Tuấn},
  title = {Bui Tuan Anh: Mô hình hỗn hợp (Mixed-effects model) I},
  url = {https://bui-tuananh.github.io/posts/2024-07-21-mixed-model-intercept/},
  year = {2024}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<div>
Michael Clark • 2022 •  <a href="https://m-clark.github.io">https://m-clark.github.io/</a>
</div>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
